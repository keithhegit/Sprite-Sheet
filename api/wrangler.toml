#:schema node_modules/wrangler/config-schema.json
name = "ogsprite-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# ==================================================================================
# D1 数据库绑定
# ==================================================================================
# 本地开发使用 local-dev-db
# 生产环境请替换为真实的 D1 数据库 ID（通过 wrangler d1 create 创建）
[[d1_databases]]
binding = "DB"
database_name = "sprite_sheet"
database_id = "4038b352-47f9-41c1-b543-861889571b16"

# ==================================================================================
# R2 存储绑定
# ==================================================================================
# 生产环境需在 Cloudflare Dashboard 创建同名 R2 Bucket
[[r2_buckets]]
binding = "R2"
bucket_name = "sprite"

# ==================================================================================
# KV 命名空间绑定（可选）
# ==================================================================================
# 如果需要使用 KV，请在 Dashboard 创建并填入 ID
# [[kv_namespaces]]
# binding = "KV"
# id = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

# ==================================================================================
# 环境变量（公开）
# ==================================================================================
# 注意：这些变量会被打包到 Worker 中，不要在此处存储敏感信息
[vars]
FRONTEND_URL = "https://sprite-sheet.pages.dev"
R2_PREFIX = "sprite_sheet"

# ==================================================================================
# 敏感环境变量（Secrets）
# ==================================================================================
# 以下敏感变量请使用以下方式之一配置：
# 1. 命令行: wrangler secret put JWT_SECRET
# 2. Dashboard: Settings -> Variables -> Encrypted
#
# 必需的 Secrets:
# - JWT_SECRET: JWT 签名密钥（建议使用长度 >= 32 的随机字符串）
#
# 生成强密钥示例（Node.js）:
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# ==================================================================================
# 本地开发配置
# ==================================================================================
[dev]
persist_to = ".wrangler/state"  # 本地状态持久化目录（D1/R2/KV 数据）
